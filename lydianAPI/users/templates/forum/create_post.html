{% extends './index.html' %}
{% block home_content %}
<div class="auth-container">
    <div class="card auth-card">
        <h3 class="card-header">
            Create a Post
        </h3>
        <div class="card-body">
            <form method="post" enctype="multipart/form-data"> <!-- Add enctype for file upload -->
                {% csrf_token %}
                <label>Title:</label>
                <input type="text" name="title" required><br>
                <label>Description:</label>
                <textarea name="description" required></textarea><br>
                <label>Image:</label>
                <input type="file" name="image"><br>
                <label for="color">Color:</label>
                <select id="color" name="color">
                    <option value="orange">Orange</option>
                    <option value="white">White</option>
                    <option value="beige">Beige</option>
                    <option value="black">Black</option>
                    <option value="other">Other</option>
                </select><br>

                <label for="shape">Shape:</label>
                <select id="shape" name="shape">
                    <option value="cylinder">Cylinder</option>
                    <option value="square">Square</option>
                    <option value="other">Other</option>
                </select><br>

                <label for="material">Material:</label>
                <select id="material" name="material">
                    <option value="plastic">Plastic</option>
                    <option value="metal">Metal</option>
                    <option value="other">Other</option>
                </select><br>

                <label for="weight">Weight:</label>
                <select id="weight" name="weight">
                    <option value="0-2.5kg">0-2.5kg</option>
                    <option value="2.5-5kg">2.5-5kg</option>
                    <option value="5-10kg">5-10kg</option>
                    <option value="other">Other</option>
                </select><br>
                <label for="location">Location:</label>
                <select id="location" name="location">
                    <option value="europe">Europe</option>
                    <option value="asia">Asia</option>
                    <option value="north america">North America</option>
                    <option value="south america">South America</option>
                    <option value="africa">Africa</option>
                    <option value="australia">Australia</option>
                    <option value="antarctica">Antarctica</option>
                    <option value="other">Other</option>
                </select><br>

                <label for="hardness">Hardness:</label>
                <select id="hardness" name="hardness">
                    <option value="soft">Soft</option>
                    <option value="medium">Medium</option>
                    <option value="hard">Hard</option>
                    <option value="rigid">Rigid</option>
                    <option value="other">Other</option>
                </select><br>
                
                <label for="time_period">Time Period:</label>
                <select id="time_period" name="time_period">
                    <option value="stone age">stone age</option>
                    <option value="iron age">iron age</option>
                    <option value="classical era">classical era</option>
                    <option value="medieval era">medieval era</option>
                    <option value="early modern era">early modern era</option>
                    <option value="modern era">modern era</option>
                    <option value="other">Other</option>
                </select><br>
                <label for="smell">Smell:</label>
                <select id="smell" name="smell">
                    <option value="woody">woody</option>
                    <option value="fragrant">fragrant</option>
                    <option value="fruity">fruity</option>
                    <option value="minty">minty</option>
                    <option value="sweet">sweet</option>
                    <option value="popcorn">popcorn</option>
                    <option value="lemon">lemon</option>
                    <option value="chemical">chemical</option>
                    <option value="pungent">pungent</option>
                    <option value="decayed">decayed</option>
                    <option value="none">none</option>
                    <option value="other">Other</option>
                </select><br>
                <label for="taste">Taste:</label>
                <select id="taste" name="taste">
                    <option value="sweet">sweet</option>
                    <option value="sour">sour</option>
                    <option value="bitter">bitter</option>
                    <option value="salty">salty</option>
                    <option value="umami">umami</option>
                    <option value="savory">savory</option>
                    <option value="other">Other</option>
                </select><br>
                <label for="texture">Texture:</label>
                <select id="texture" name="texture">
                    <option value="smooth">smooth</option>
                    <option value="rough">rough</option>
                    <option value="grainy">grainy</option>
                    <option value="slimy">slimy</option>
                    <option value="other">Other</option>
                </select><br>
                <label for="value">Value:</label>
                <select id="value" name="value">
                    <option value="low">low</option>
                    <option value="medium">Medium</option>
                    <option value="high">high</option>
                    <option value="luxury">luxury</option>
                    <option value="other">Other</option>
                </select><br>
                <label>Tags</label>
                <input type="text" id="tag-search" placeholder="Search for tags...">
                <ul id="tag-results" style="list-style: none;"></ul>
                <div id="selected-tags">
                    <h6>Selected Tags:</h6>
                </div>
                <input type="hidden" name="tags" id="tags-input">
                <button class="btn btn-register" type="submit">Post</button>
            </form>
        </div>
    </div>
</div>
<script>
    document.getElementById('tag-search').addEventListener('input', function () {
        const query = this.value;
        if (query.length < 2) return;

        fetch(`/search_wikidata/?query=${query}`)
            .then(response => response.json())
            .then(data => {
                const resultsContainer = document.getElementById('tag-results');
                resultsContainer.innerHTML = '';

                data.results.forEach(item => {
                    const li = document.createElement('li');
                    li.textContent = `${item.label} (${item.description || 'No description'})`;
                    li.dataset.id = item.id;
                    li.dataset.label = item.label;

                    li.addEventListener('click', function () {
                        const tagContainer = document.getElementById('selected-tags');
                        const selectedTag = document.createElement('div');
                        selectedTag.textContent = this.dataset.label;
                        tagContainer.appendChild(selectedTag);

                        const tagsInput = document.getElementById('tags-input');
                        tagsInput.value += this.dataset.label + ',';

                        resultsContainer.innerHTML = '';
                    });

                    resultsContainer.appendChild(li);
                });
            });
    });
</script>
{% endblock home_content %}